import 'dart:convert';
import 'dart:math' as math;

import 'package:http/http.dart' as http;
import 'package:linalg/linalg.dart';

class Country {
  final String country, slug, iso2;
  double latitude, longitude;

  Country({this.country, this.slug, this.iso2});
  factory Country.fromJSON(Map<String, dynamic> json) {
    return Country(
      country: json['Country'],
      slug: json['Slug'],
      iso2: json['ISO2'],
    );
  }

  @override
  String toString() {
    String corrected = country;
    if (country.contains(',') && country.endsWith('of')) {
      final parts = country.split(',');
      corrected = '${parts[1].trim()} ${parts[0].trim()}';
    }
    return '$corrected ($iso2)';
  }
}

class Case {
  final DateTime date;
  final int confirmed, deaths, recovered, active;

  Case({this.date, this.confirmed, this.deaths, this.recovered, this.active});
  factory Case.fromJSON(Map<String, dynamic> json) {
    return Case(
      date: DateTime.parse(json['Date']),
      confirmed: json['Confirmed'],
      deaths: json['Deaths'],
      recovered: json['Recovered'],
      active: json['Active'],
    );
  }

  @override
  String toString() {
    return '$date: C$confirmed | D$deaths | R$recovered | A$active';
  }
}

class CountryCase {
  final Country country;
  final List<Case> cases;

  CountryCase({this.country}) : cases = [];
  void addCaseFromJSON(Map<String, dynamic> json) => cases.add(Case.fromJSON(json));
  Case getIncrease(int n) {
    return Case(
      date: cases[n].date,
      confirmed: cases[n].confirmed - cases[n - 1].confirmed,
      deaths: cases[n].deaths - cases[n - 1].deaths,
      recovered: cases[n].recovered - cases[n - 1].recovered,
      active: cases[n].active - cases[n - 1].active,
    );
  }
}

class CovidAPI {
  static Map<Country, CountryCase> _casesCache = Map();

  static Future<List<Country>> getCountries() async {
    // final res = await http.get('https://api.covid19api.com/countries');
    // await Future.delayed(Duration(seconds: 1));
    final res = http.Response(
        '''[{"Country":"Barbados","Slug":"barbados","ISO2":"BB"},{"Country":"Gibraltar","Slug":"gibraltar","ISO2":"GI"},{"Country":"Lithuania","Slug":"lithuania","ISO2":"LT"},{"Country":"Malaysia","Slug":"malaysia","ISO2":"MY"},{"Country":"Nauru","Slug":"nauru","ISO2":"NR"},{"Country":"Palestinian Territory","Slug":"palestine","ISO2":"PS"},{"Country":"Qatar","Slug":"qatar","ISO2":"QA"},{"Country":"Solomon Islands","Slug":"solomon-islands","ISO2":"SB"},{"Country":"Sri Lanka","Slug":"sri-lanka","ISO2":"LK"},{"Country":"Turks and Caicos Islands","Slug":"turks-and-caicos-islands","ISO2":"TC"},{"Country":"Vanuatu","Slug":"vanuatu","ISO2":"VU"},{"Country":"Wallis and Futuna Islands","Slug":"wallis-and-futuna-islands","ISO2":"WF"},{"Country":"Dominica","Slug":"dominica","ISO2":"DM"},{"Country":"Gambia","Slug":"gambia","ISO2":"GM"},{"Country":"Iran, Islamic Republic of","Slug":"iran","ISO2":"IR"},{"Country":"Namibia","Slug":"namibia","ISO2":"NA"},{"Country":"Tokelau","Slug":"tokelau","ISO2":"TK"},{"Country":"Guinea","Slug":"guinea","ISO2":"GN"},{"Country":"Morocco","Slug":"morocco","ISO2":"MA"},{"Country":"Tunisia","Slug":"tunisia","ISO2":"TN"},{"Country":"Azerbaijan","Slug":"azerbaijan","ISO2":"AZ"},{"Country":"Honduras","Slug":"honduras","ISO2":"HN"},{"Country":"Saint-Martin (French part)","Slug":"saint-martin-french-part","ISO2":"MF"},{"Country":"Chad","Slug":"chad","ISO2":"TD"},{"Country":"Christmas Island","Slug":"christmas-island","ISO2":"CX"},{"Country":"Costa Rica","Slug":"costa-rica","ISO2":"CR"},{"Country":"Bulgaria","Slug":"bulgaria","ISO2":"BG"},{"Country":"Denmark","Slug":"denmark","ISO2":"DK"},{"Country":"Malawi","Slug":"malawi","ISO2":"MW"},{"Country":"Nepal","Slug":"nepal","ISO2":"NP"},{"Country":"Switzerland","Slug":"switzerland","ISO2":"CH"},{"Country":"Canada","Slug":"canada","ISO2":"CA"},{"Country":"China","Slug":"china","ISO2":"CN"},{"Country":"Grenada","Slug":"grenada","ISO2":"GD"},{"Country":"Andorra","Slug":"andorra","ISO2":"AD"},{"Country":"Belgium","Slug":"belgium","ISO2":"BE"},{"Country":"Burkina Faso","Slug":"burkina-faso","ISO2":"BF"},{"Country":"Cayman Islands","Slug":"cayman-islands","ISO2":"KY"},{"Country":"Estonia","Slug":"estonia","ISO2":"EE"},{"Country":"Jersey","Slug":"jersey","ISO2":"JE"},{"Country":"Montserrat","Slug":"montserrat","ISO2":"MS"},{"Country":"Oman","Slug":"oman","ISO2":"OM"},{"Country":"Cameroon","Slug":"cameroon","ISO2":"CM"},{"Country":"Luxembourg","Slug":"luxembourg","ISO2":"LU"},{"Country":"Slovakia","Slug":"slovakia","ISO2":"SK"},{"Country":"Bosnia and Herzegovina","Slug":"bosnia-and-herzegovina","ISO2":"BA"},{"Country":"Moldova","Slug":"moldova","ISO2":"MD"},{"Country":"Brunei Darussalam","Slug":"brunei","ISO2":"BN"},{"Country":"Eritrea","Slug":"eritrea","ISO2":"ER"},{"Country":"Jordan","Slug":"jordan","ISO2":"JO"},{"Country":"Liberia","Slug":"liberia","ISO2":"LR"},{"Country":"Portugal","Slug":"portugal","ISO2":"PT"},{"Country":"Ukraine","Slug":"ukraine","ISO2":"UA"},{"Country":"Indonesia","Slug":"indonesia","ISO2":"ID"},{"Country":"Kenya","Slug":"kenya","ISO2":"KE"},{"Country":"Georgia","Slug":"georgia","ISO2":"GE"},{"Country":"Iceland","Slug":"iceland","ISO2":"IS"},{"Country":"Jamaica","Slug":"jamaica","ISO2":"JM"},{"Country":"Norfolk Island","Slug":"norfolk-island","ISO2":"NF"},{"Country":"French Southern Territories","Slug":"french-southern-territories","ISO2":"TF"},{"Country":"Guernsey","Slug":"guernsey","ISO2":"GG"},{"Country":"Paraguay","Slug":"paraguay","ISO2":"PY"},{"Country":"Tajikistan","Slug":"tajikistan","ISO2":"TJ"},{"Country":"US Minor Outlying Islands","Slug":"us-minor-outlying-islands","ISO2":"UM"},{"Country":"Uzbekistan","Slug":"uzbekistan","ISO2":"UZ"},{"Country":"American Samoa","Slug":"american-samoa","ISO2":"AS"},{"Country":"British Virgin Islands","Slug":"british-virgin-islands","ISO2":"VG"},{"Country":"Finland","Slug":"finland","ISO2":"FI"},{"Country":"Malta","Slug":"malta","ISO2":"MT"},{"Country":"Botswana","Slug":"botswana","ISO2":"BW"},{"Country":"Israel","Slug":"israel","ISO2":"IL"},{"Country":"Saint Lucia","Slug":"saint-lucia","ISO2":"LC"},{"Country":"Spain","Slug":"spain","ISO2":"ES"},{"Country":"Argentina","Slug":"argentina","ISO2":"AR"},{"Country":"Congo (Kinshasa)","Slug":"congo-kinshasa","ISO2":"CD"},{"Country":"Réunion","Slug":"réunion","ISO2":"RE"},{"Country":"Saint-Barthélemy","Slug":"saint-barthélemy","ISO2":"BL"},{"Country":"Zambia","Slug":"zambia","ISO2":"ZM"},{"Country":"Bahrain","Slug":"bahrain","ISO2":"BH"},{"Country":"Chile","Slug":"chile","ISO2":"CL"},{"Country":"Uruguay","Slug":"uruguay","ISO2":"UY"},{"Country":"Yemen","Slug":"yemen","ISO2":"YE"},{"Country":"Austria","Slug":"austria","ISO2":"AT"},{"Country":"Bangladesh","Slug":"bangladesh","ISO2":"BD"},{"Country":"Italy","Slug":"italy","ISO2":"IT"},{"Country":"Micronesia, Federated States of","Slug":"micronesia","ISO2":"FM"},{"Country":"Puerto Rico","Slug":"puerto-rico","ISO2":"PR"},{"Country":"Tuvalu","Slug":"tuvalu","ISO2":"TV"},{"Country":"ALA Aland Islands","Slug":"ala-aland-islands","ISO2":"AX"},{"Country":"Afghanistan","Slug":"afghanistan","ISO2":"AF"},{"Country":"Cambodia","Slug":"cambodia","ISO2":"KH"},{"Country":"Sao Tome and Principe","Slug":"sao-tome-and-principe","ISO2":"ST"},{"Country":"Korea (North)","Slug":"korea-north","ISO2":"KP"},{"Country":"New Zealand","Slug":"new-zealand","ISO2":"NZ"},{"Country":"Turkey","Slug":"turkey","ISO2":"TR"},{"Country":"Greenland","Slug":"greenland","ISO2":"GL"},{"Country":"Hungary","Slug":"hungary","ISO2":"HU"},{"Country":"Australia","Slug":"australia","ISO2":"AU"},{"Country":"India","Slug":"india","ISO2":"IN"},{"Country":"San Marino","Slug":"san-marino","ISO2":"SM"},{"Country":"United Kingdom","Slug":"united-kingdom","ISO2":"GB"},{"Country":"Comoros","Slug":"comoros","ISO2":"KM"},{"Country":"Mauritania","Slug":"mauritania","ISO2":"MR"},{"Country":"Benin","Slug":"benin","ISO2":"BJ"},{"Country":"Côte d'Ivoire","Slug":"cote-divoire","ISO2":"CI"},{"Country":"Guadeloupe","Slug":"guadeloupe","ISO2":"GP"},{"Country":"Heard and Mcdonald Islands","Slug":"heard-and-mcdonald-islands","ISO2":"HM"},{"Country":"Kiribati","Slug":"kiribati","ISO2":"KI"},{"Country":"Mali","Slug":"mali","ISO2":"ML"},{"Country":"Northern Mariana Islands","Slug":"northern-mariana-islands","ISO2":"MP"},{"Country":"Palau","Slug":"palau","ISO2":"PW"},{"Country":"Myanmar","Slug":"myanmar","ISO2":"MM"},{"Country":"Somalia","Slug":"somalia","ISO2":"SO"},{"Country":"Trinidad and Tobago","Slug":"trinidad-and-tobago","ISO2":"TT"},{"Country":"Turkmenistan","Slug":"turkmenistan","ISO2":"TM"},{"Country":"French Guiana","Slug":"french-guiana","ISO2":"GF"},{"Country":"Lao PDR","Slug":"lao-pdr","ISO2":"LA"},{"Country":"United Arab Emirates","Slug":"united-arab-emirates","ISO2":"AE"},{"Country":"Albania","Slug":"albania","ISO2":"AL"},{"Country":"Ireland","Slug":"ireland","ISO2":"IE"},{"Country":"Burundi","Slug":"burundi","ISO2":"BI"},{"Country":"Cape Verde","Slug":"cape-verde","ISO2":"CV"},{"Country":"Greece","Slug":"greece","ISO2":"GR"},{"Country":"Guam","Slug":"guam","ISO2":"GU"},{"Country":"Guatemala","Slug":"guatemala","ISO2":"GT"},{"Country":"Korea (South)","Slug":"korea-south","ISO2":"KR"},{"Country":"Niger","Slug":"niger","ISO2":"NE"},{"Country":"Panama","Slug":"panama","ISO2":"PA"},{"Country":"Saint Helena","Slug":"saint-helena","ISO2":"SH"},{"Country":"Viet Nam","Slug":"vietnam","ISO2":"VN"},{"Country":"Saint Kitts and Nevis","Slug":"saint-kitts-and-nevis","ISO2":"KN"},{"Country":"Seychelles","Slug":"seychelles","ISO2":"SC"},{"Country":"Timor-Leste","Slug":"timor-leste","ISO2":"TL"},{"Country":"Bouvet Island","Slug":"bouvet-island","ISO2":"BV"},{"Country":"El Salvador","Slug":"el-salvador","ISO2":"SV"},{"Country":"Russian Federation","Slug":"russia","ISO2":"RU"},{"Country":"Slovenia","Slug":"slovenia","ISO2":"SI"},{"Country":"French Polynesia","Slug":"french-polynesia","ISO2":"PF"},{"Country":"Hong Kong, SAR China","Slug":"hong-kong-sar-china","ISO2":"HK"},{"Country":"Madagascar","Slug":"madagascar","ISO2":"MG"},{"Country":"Nigeria","Slug":"nigeria","ISO2":"NG"},{"Country":"Samoa","Slug":"samoa","ISO2":"WS"},{"Country":"British Indian Ocean Territory","Slug":"british-indian-ocean-territory","ISO2":"IO"},{"Country":"Equatorial Guinea","Slug":"equatorial-guinea","ISO2":"GQ"},{"Country":"Holy See (Vatican City State)","Slug":"holy-see-vatican-city-state","ISO2":"VA"},{"Country":"Rwanda","Slug":"rwanda","ISO2":"RW"},{"Country":"Saint Vincent and Grenadines","Slug":"saint-vincent-and-the-grenadines","ISO2":"VC"},{"Country":"Virgin Islands, US","Slug":"virgin-islands","ISO2":"VI"},{"Country":"Congo (Brazzaville)","Slug":"congo-brazzaville","ISO2":"CG"},{"Country":"Guyana","Slug":"guyana","ISO2":"GY"},{"Country":"Haiti","Slug":"haiti","ISO2":"HT"},{"Country":"Marshall Islands","Slug":"marshall-islands","ISO2":"MH"},{"Country":"Singapore","Slug":"singapore","ISO2":"SG"},{"Country":"Bhutan","Slug":"bhutan","ISO2":"BT"},{"Country":"Ghana","Slug":"ghana","ISO2":"GH"},{"Country":"Mozambique","Slug":"mozambique","ISO2":"MZ"},{"Country":"Antigua and Barbuda","Slug":"antigua-and-barbuda","ISO2":"AG"},{"Country":"Cocos (Keeling) Islands","Slug":"cocos-keeling-islands","ISO2":"CC"},{"Country":"Cyprus","Slug":"cyprus","ISO2":"CY"},{"Country":"Latvia","Slug":"latvia","ISO2":"LV"},{"Country":"Lebanon","Slug":"lebanon","ISO2":"LB"},{"Country":"Cook Islands","Slug":"cook-islands","ISO2":"CK"},{"Country":"Isle of Man","Slug":"isle-of-man","ISO2":"IM"},{"Country":"Libya","Slug":"libya","ISO2":"LY"},{"Country":"Netherlands","Slug":"netherlands","ISO2":"NL"},{"Country":"New Caledonia","Slug":"new-caledonia","ISO2":"NC"},{"Country":"Niue","Slug":"niue","ISO2":"NU"},{"Country":"Thailand","Slug":"thailand","ISO2":"TH"},{"Country":"Egypt","Slug":"egypt","ISO2":"EG"},{"Country":"Faroe Islands","Slug":"faroe-islands","ISO2":"FO"},{"Country":"South Georgia and the South Sandwich Islands","Slug":"south-georgia-and-the-south-sandwich-islands","ISO2":"GS"},{"Country":"Algeria","Slug":"algeria","ISO2":"DZ"},{"Country":"Brazil","Slug":"brazil","ISO2":"BR"},{"Country":"Central African Republic","Slug":"central-african-republic","ISO2":"CF"},{"Country":"Czech Republic","Slug":"czech-republic","ISO2":"CZ"},{"Country":"Ecuador","Slug":"ecuador","ISO2":"EC"},{"Country":"Gabon","Slug":"gabon","ISO2":"GA"},{"Country":"Zimbabwe","Slug":"zimbabwe","ISO2":"ZW"},{"Country":"Peru","Slug":"peru","ISO2":"PE"},{"Country":"Saint Pierre and Miquelon","Slug":"saint-pierre-and-miquelon","ISO2":"PM"},{"Country":"Republic of Kosovo","Slug":"kosovo","ISO2":"XK"},{"Country":"Tonga","Slug":"tonga","ISO2":"TO"},{"Country":"South Sudan","Slug":"south-sudan","ISO2":"SS"},{"Country":"Colombia","Slug":"colombia","ISO2":"CO"},{"Country":"Germany","Slug":"germany","ISO2":"DE"},{"Country":"Lesotho","Slug":"lesotho","ISO2":"LS"},{"Country":"Falkland Islands (Malvinas)","Slug":"falkland-islands-malvinas","ISO2":"FK"},{"Country":"Saudi Arabia","Slug":"saudi-arabia","ISO2":"SA"},{"Country":"Aruba","Slug":"aruba","ISO2":"AW"},{"Country":"Swaziland","Slug":"swaziland","ISO2":"SZ"},{"Country":"United States of America","Slug":"united-states","ISO2":"US"},{"Country":"Antarctica","Slug":"antarctica","ISO2":"AQ"},{"Country":"Cuba","Slug":"cuba","ISO2":"CU"},{"Country":"Monaco","Slug":"monaco","ISO2":"MC"},{"Country":"Serbia","Slug":"serbia","ISO2":"RS"},{"Country":"Anguilla","Slug":"anguilla","ISO2":"AI"},{"Country":"Maldives","Slug":"maldives","ISO2":"MV"},{"Country":"Romania","Slug":"romania","ISO2":"RO"},{"Country":"Uganda","Slug":"uganda","ISO2":"UG"},{"Country":"Japan","Slug":"japan","ISO2":"JP"},{"Country":"Belarus","Slug":"belarus","ISO2":"BY"},{"Country":"France","Slug":"france","ISO2":"FR"},{"Country":"Western Sahara","Slug":"western-sahara","ISO2":"EH"},{"Country":"Iraq","Slug":"iraq","ISO2":"IQ"},{"Country":"Norway","Slug":"norway","ISO2":"NO"},{"Country":"Philippines","Slug":"philippines","ISO2":"PH"},{"Country":"Bahamas","Slug":"bahamas","ISO2":"BS"},{"Country":"Dominican Republic","Slug":"dominican-republic","ISO2":"DO"},{"Country":"Macao, SAR China","Slug":"macao-sar-china","ISO2":"MO"},{"Country":"Bermuda","Slug":"bermuda","ISO2":"BM"},{"Country":"Pakistan","Slug":"pakistan","ISO2":"PK"},{"Country":"Pitcairn","Slug":"pitcairn","ISO2":"PN"},{"Country":"Tanzania, United Republic of","Slug":"tanzania","ISO2":"TZ"},{"Country":"Bolivia","Slug":"bolivia","ISO2":"BO"},{"Country":"Kazakhstan","Slug":"kazakhstan","ISO2":"KZ"},{"Country":"Kyrgyzstan","Slug":"kyrgyzstan","ISO2":"KG"},{"Country":"Taiwan, Republic of China","Slug":"taiwan","ISO2":"TW"},{"Country":"Armenia","Slug":"armenia","ISO2":"AM"},{"Country":"Svalbard and Jan Mayen Islands","Slug":"svalbard-and-jan-mayen-islands","ISO2":"SJ"},{"Country":"Sweden","Slug":"sweden","ISO2":"SE"},{"Country":"Togo","Slug":"togo","ISO2":"TG"},{"Country":"Fiji","Slug":"fiji","ISO2":"FJ"},{"Country":"Martinique","Slug":"martinique","ISO2":"MQ"},{"Country":"Montenegro","Slug":"montenegro","ISO2":"ME"},{"Country":"Suriname","Slug":"suriname","ISO2":"SR"},{"Country":"Venezuela (Bolivarian Republic)","Slug":"venezuela","ISO2":"VE"},{"Country":"Angola","Slug":"angola","ISO2":"AO"},{"Country":"Macedonia, Republic of","Slug":"macedonia","ISO2":"MK"},{"Country":"Mauritius","Slug":"mauritius","ISO2":"MU"},{"Country":"Mayotte","Slug":"mayotte","ISO2":"YT"},{"Country":"Senegal","Slug":"senegal","ISO2":"SN"},{"Country":"South Africa","Slug":"south-africa","ISO2":"ZA"},{"Country":"Syrian Arab Republic (Syria)","Slug":"syria","ISO2":"SY"},{"Country":"Liechtenstein","Slug":"liechtenstein","ISO2":"LI"},{"Country":"Netherlands Antilles","Slug":"netherlands-antilles","ISO2":"AN"},{"Country":"Croatia","Slug":"croatia","ISO2":"HR"},{"Country":"Djibouti","Slug":"djibouti","ISO2":"DJ"},{"Country":"Mexico","Slug":"mexico","ISO2":"MX"},{"Country":"Belize","Slug":"belize","ISO2":"BZ"},{"Country":"Guinea-Bissau","Slug":"guinea-bissau","ISO2":"GW"},{"Country":"Mongolia","Slug":"mongolia","ISO2":"MN"},{"Country":"Poland","Slug":"poland","ISO2":"PL"},{"Country":"Ethiopia","Slug":"ethiopia","ISO2":"ET"},{"Country":"Kuwait","Slug":"kuwait","ISO2":"KW"},{"Country":"Nicaragua","Slug":"nicaragua","ISO2":"NI"},{"Country":"Papua New Guinea","Slug":"papua-new-guinea","ISO2":"PG"},{"Country":"Sierra Leone","Slug":"sierra-leone","ISO2":"SL"},{"Country":"Sudan","Slug":"sudan","ISO2":"SD"}]''',
        200);
    if (res.statusCode == 200) {
      final List countries = json.decode(res.body);
      return countries.map((e) => Country.fromJSON(e)).toList()..sort((c1, c2) => c1.country.compareTo(c2.country));
    } else
      throw Exception('Failed to fetch countries');
  }

  static Future<CountryCase> getCasesByCountry(Country country) async {
    if (_casesCache.containsKey(country)) return _casesCache[country];
    final res = await http.get('https://api.covid19api.com/total/dayone/country/${country.slug}');
    // final res = http.Response('[{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1,"Deaths":0,"Recovered":0,"Active":1,"Date":"2020-01-22T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1,"Deaths":0,"Recovered":0,"Active":1,"Date":"2020-01-23T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2,"Deaths":0,"Recovered":0,"Active":2,"Date":"2020-01-24T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2,"Deaths":0,"Recovered":0,"Active":2,"Date":"2020-01-25T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":5,"Deaths":0,"Recovered":0,"Active":5,"Date":"2020-01-26T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":5,"Deaths":0,"Recovered":0,"Active":5,"Date":"2020-01-27T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":5,"Deaths":0,"Recovered":0,"Active":5,"Date":"2020-01-28T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":5,"Deaths":0,"Recovered":0,"Active":5,"Date":"2020-01-29T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":5,"Deaths":0,"Recovered":0,"Active":5,"Date":"2020-01-30T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":7,"Deaths":0,"Recovered":0,"Active":7,"Date":"2020-01-31T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":8,"Deaths":0,"Recovered":0,"Active":8,"Date":"2020-02-01T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":8,"Deaths":0,"Recovered":0,"Active":8,"Date":"2020-02-02T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":0,"Active":11,"Date":"2020-02-03T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":0,"Active":11,"Date":"2020-02-04T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":0,"Active":11,"Date":"2020-02-05T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":0,"Active":11,"Date":"2020-02-06T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":0,"Active":11,"Date":"2020-02-07T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":0,"Active":11,"Date":"2020-02-08T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":3,"Active":8,"Date":"2020-02-09T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":11,"Deaths":0,"Recovered":3,"Active":8,"Date":"2020-02-10T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":12,"Deaths":0,"Recovered":3,"Active":9,"Date":"2020-02-11T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":12,"Deaths":0,"Recovered":3,"Active":9,"Date":"2020-02-12T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-13T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-14T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-15T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-16T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-17T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-18T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-19T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":13,"Deaths":0,"Recovered":3,"Active":10,"Date":"2020-02-20T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":15,"Deaths":0,"Recovered":5,"Active":10,"Date":"2020-02-21T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":15,"Deaths":0,"Recovered":5,"Active":10,"Date":"2020-02-22T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":15,"Deaths":0,"Recovered":5,"Active":10,"Date":"2020-02-23T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":15,"Deaths":0,"Recovered":5,"Active":10,"Date":"2020-02-24T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":15,"Deaths":0,"Recovered":6,"Active":9,"Date":"2020-02-25T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":15,"Deaths":0,"Recovered":6,"Active":9,"Date":"2020-02-26T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":16,"Deaths":0,"Recovered":6,"Active":10,"Date":"2020-02-27T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":16,"Deaths":0,"Recovered":7,"Active":9,"Date":"2020-02-28T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":24,"Deaths":1,"Recovered":7,"Active":16,"Date":"2020-02-29T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":30,"Deaths":1,"Recovered":7,"Active":22,"Date":"2020-03-01T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":53,"Deaths":6,"Recovered":7,"Active":40,"Date":"2020-03-02T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":73,"Deaths":7,"Recovered":7,"Active":59,"Date":"2020-03-03T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":104,"Deaths":11,"Recovered":7,"Active":86,"Date":"2020-03-04T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":174,"Deaths":12,"Recovered":7,"Active":155,"Date":"2020-03-05T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":222,"Deaths":14,"Recovered":7,"Active":201,"Date":"2020-03-06T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":337,"Deaths":17,"Recovered":7,"Active":313,"Date":"2020-03-07T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":451,"Deaths":21,"Recovered":7,"Active":423,"Date":"2020-03-08T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":519,"Deaths":22,"Recovered":7,"Active":490,"Date":"2020-03-09T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":711,"Deaths":28,"Recovered":8,"Active":675,"Date":"2020-03-10T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1109,"Deaths":33,"Recovered":8,"Active":1068,"Date":"2020-03-11T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1561,"Deaths":43,"Recovered":12,"Active":1506,"Date":"2020-03-12T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2157,"Deaths":52,"Recovered":12,"Active":2093,"Date":"2020-03-13T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2870,"Deaths":58,"Recovered":12,"Active":2800,"Date":"2020-03-14T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2968,"Deaths":70,"Recovered":12,"Active":2886,"Date":"2020-03-15T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":4360,"Deaths":97,"Recovered":17,"Active":4246,"Date":"2020-03-16T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":6141,"Deaths":131,"Recovered":17,"Active":5993,"Date":"2020-03-17T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":8917,"Deaths":188,"Recovered":105,"Active":8624,"Date":"2020-03-18T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":14157,"Deaths":265,"Recovered":121,"Active":13771,"Date":"2020-03-19T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":19479,"Deaths":362,"Recovered":147,"Active":18970,"Date":"2020-03-20T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":25825,"Deaths":456,"Recovered":176,"Active":25193,"Date":"2020-03-21T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":33761,"Deaths":601,"Recovered":178,"Active":32982,"Date":"2020-03-22T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":43850,"Deaths":784,"Recovered":178,"Active":42888,"Date":"2020-03-23T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":54112,"Deaths":1021,"Recovered":348,"Active":52743,"Date":"2020-03-24T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":66055,"Deaths":1333,"Recovered":361,"Active":64361,"Date":"2020-03-25T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":84091,"Deaths":1746,"Recovered":681,"Active":81664,"Date":"2020-03-26T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":102276,"Deaths":2300,"Recovered":869,"Active":99107,"Date":"2020-03-27T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":122069,"Deaths":2934,"Recovered":1072,"Active":118063,"Date":"2020-03-28T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":141205,"Deaths":3561,"Recovered":2665,"Active":134979,"Date":"2020-03-29T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":162707,"Deaths":4381,"Recovered":5644,"Active":152682,"Date":"2020-03-30T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":188724,"Deaths":5605,"Recovered":7024,"Active":176095,"Date":"2020-03-31T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":214205,"Deaths":6846,"Recovered":8474,"Active":198885,"Date":"2020-04-01T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":244610,"Deaths":8432,"Recovered":9001,"Active":227177,"Date":"2020-04-02T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":276547,"Deaths":9747,"Recovered":9707,"Active":257093,"Date":"2020-04-03T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":309699,"Deaths":11031,"Recovered":14652,"Active":284016,"Date":"2020-04-04T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":337573,"Deaths":12470,"Recovered":17448,"Active":307655,"Date":"2020-04-05T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":367215,"Deaths":14138,"Recovered":19581,"Active":333496,"Date":"2020-04-06T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":397992,"Deaths":16447,"Recovered":21763,"Active":359782,"Date":"2020-04-07T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":429686,"Deaths":18563,"Recovered":23559,"Active":387564,"Date":"2020-04-08T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":464442,"Deaths":20638,"Recovered":25410,"Active":418394,"Date":"2020-04-09T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":497943,"Deaths":22731,"Recovered":28790,"Active":446422,"Date":"2020-04-10T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":527969,"Deaths":24777,"Recovered":31270,"Active":471922,"Date":"2020-04-11T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":556522,"Deaths":26548,"Recovered":32988,"Active":496986,"Date":"2020-04-12T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":581813,"Deaths":28376,"Recovered":43482,"Active":509955,"Date":"2020-04-13T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":608878,"Deaths":30780,"Recovered":47763,"Active":530335,"Date":"2020-04-14T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":637974,"Deaths":33329,"Recovered":52096,"Active":552549,"Date":"2020-04-15T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":669272,"Deaths":35442,"Recovered":54703,"Active":579127,"Date":"2020-04-16T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":701996,"Deaths":38056,"Recovered":58545,"Active":605395,"Date":"2020-04-17T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":730337,"Deaths":40442,"Recovered":64840,"Active":625055,"Date":"2020-04-18T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":756375,"Deaths":41671,"Recovered":70337,"Active":644367,"Date":"2020-04-19T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":783716,"Deaths":43466,"Recovered":72329,"Active":667921,"Date":"2020-04-20T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":809228,"Deaths":45919,"Recovered":75204,"Active":688105,"Date":"2020-04-21T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":837422,"Deaths":48312,"Recovered":77366,"Active":711744,"Date":"2020-04-22T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":871617,"Deaths":50749,"Recovered":80203,"Active":740665,"Date":"2020-04-23T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":907908,"Deaths":52867,"Recovered":99079,"Active":755962,"Date":"2020-04-24T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":940829,"Deaths":54517,"Recovered":100372,"Active":785940,"Date":"2020-04-25T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":968518,"Deaths":55810,"Recovered":106988,"Active":805720,"Date":"2020-04-26T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":990999,"Deaths":57233,"Recovered":111424,"Active":822342,"Date":"2020-04-27T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1015518,"Deaths":59454,"Recovered":115936,"Active":840128,"Date":"2020-04-28T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1042926,"Deaths":61955,"Recovered":120720,"Active":860251,"Date":"2020-04-29T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1072667,"Deaths":64256,"Recovered":153947,"Active":854464,"Date":"2020-04-30T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1106829,"Deaths":66125,"Recovered":164015,"Active":876689,"Date":"2020-05-01T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1136024,"Deaths":67681,"Recovered":175382,"Active":892961,"Date":"2020-05-02T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1161611,"Deaths":68777,"Recovered":180152,"Active":912682,"Date":"2020-05-03T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1184086,"Deaths":70086,"Recovered":187180,"Active":926820,"Date":"2020-05-04T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1208271,"Deaths":72393,"Recovered":189791,"Active":946087,"Date":"2020-05-05T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1233527,"Deaths":74851,"Recovered":189910,"Active":968766,"Date":"2020-05-06T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1261409,"Deaths":76770,"Recovered":195036,"Active":989603,"Date":"2020-05-07T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1288587,"Deaths":78497,"Recovered":198993,"Active":1011097,"Date":"2020-05-08T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1314320,"Deaths":79976,"Recovered":212534,"Active":1021810,"Date":"2020-05-09T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1334084,"Deaths":80855,"Recovered":216169,"Active":1037060,"Date":"2020-05-10T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1352962,"Deaths":81868,"Recovered":232733,"Active":1038361,"Date":"2020-05-11T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1374916,"Deaths":83480,"Recovered":230287,"Active":1061149,"Date":"2020-05-12T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1396109,"Deaths":85234,"Recovered":243430,"Active":1067445,"Date":"2020-05-13T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1423726,"Deaths":87008,"Recovered":246414,"Active":1090304,"Date":"2020-05-14T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1449026,"Deaths":88669,"Recovered":250747,"Active":1109610,"Date":"2020-05-15T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1474127,"Deaths":89892,"Recovered":268376,"Active":1115859,"Date":"2020-05-16T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1493131,"Deaths":90644,"Recovered":272265,"Active":1130222,"Date":"2020-05-17T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1514900,"Deaths":91414,"Recovered":283178,"Active":1140308,"Date":"2020-05-18T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1535349,"Deaths":92965,"Recovered":289392,"Active":1152992,"Date":"2020-05-19T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1558970,"Deaths":94528,"Recovered":294312,"Active":1170130,"Date":"2020-05-20T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1584511,"Deaths":95756,"Recovered":298418,"Active":1190337,"Date":"2020-05-21T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1608652,"Deaths":97025,"Recovered":350135,"Active":1161492,"Date":"2020-05-22T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1630475,"Deaths":98146,"Recovered":361239,"Active":1171090,"Date":"2020-05-23T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1651288,"Deaths":98754,"Recovered":366736,"Active":1185798,"Date":"2020-05-24T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1670279,"Deaths":99267,"Recovered":379157,"Active":1191855,"Date":"2020-05-25T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1689162,"Deaths":99952,"Recovered":384902,"Active":1204308,"Date":"2020-05-26T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1707444,"Deaths":101461,"Recovered":391508,"Active":1214475,"Date":"2020-05-27T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1730259,"Deaths":102643,"Recovered":399991,"Active":1227625,"Date":"2020-05-28T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1754763,"Deaths":103809,"Recovered":406446,"Active":1244508,"Date":"2020-05-29T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1778993,"Deaths":104773,"Recovered":416461,"Active":1257759,"Date":"2020-05-30T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1799122,"Deaths":105364,"Recovered":444758,"Active":1249000,"Date":"2020-05-31T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1816476,"Deaths":106136,"Recovered":458231,"Active":1252109,"Date":"2020-06-01T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1837371,"Deaths":107169,"Recovered":463868,"Active":1266334,"Date":"2020-06-02T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1857329,"Deaths":108159,"Recovered":479258,"Active":1269912,"Date":"2020-06-03T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1878680,"Deaths":109168,"Recovered":485002,"Active":1284510,"Date":"2020-06-04T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1903904,"Deaths":110138,"Recovered":491706,"Active":1302060,"Date":"2020-06-05T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1926636,"Deaths":110818,"Recovered":500849,"Active":1314969,"Date":"2020-06-06T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1944367,"Deaths":111269,"Recovered":506367,"Active":1326731,"Date":"2020-06-07T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1961781,"Deaths":111774,"Recovered":518522,"Active":1331485,"Date":"2020-06-08T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":1979908,"Deaths":112714,"Recovered":524855,"Active":1342339,"Date":"2020-06-09T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2000702,"Deaths":113631,"Recovered":533504,"Active":1353567,"Date":"2020-06-10T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2023652,"Deaths":114512,"Recovered":540292,"Active":1368848,"Date":"2020-06-11T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2048986,"Deaths":115334,"Recovered":547386,"Active":1386266,"Date":"2020-06-12T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2074542,"Deaths":116084,"Recovered":556606,"Active":1401852,"Date":"2020-06-13T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2094366,"Deaths":116382,"Recovered":561816,"Active":1416168,"Date":"2020-06-14T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2114026,"Deaths":116773,"Recovered":576334,"Active":1420919,"Date":"2020-06-15T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2137731,"Deaths":117612,"Recovered":583503,"Active":1436616,"Date":"2020-06-16T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2163290,"Deaths":118363,"Recovered":592191,"Active":1452736,"Date":"2020-06-17T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2191099,"Deaths":119067,"Recovered":599115,"Active":1472917,"Date":"2020-06-18T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2222579,"Deaths":119739,"Recovered":606715,"Active":1496125,"Date":"2020-06-19T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2255327,"Deaths":120349,"Recovered":617460,"Active":1517518,"Date":"2020-06-20T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2281766,"Deaths":120604,"Recovered":622133,"Active":1539029,"Date":"2020-06-21T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2312302,"Deaths":121010,"Recovered":640198,"Active":1551094,"Date":"2020-06-22T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2347491,"Deaths":121847,"Recovered":647548,"Active":1578096,"Date":"2020-06-23T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2382426,"Deaths":122604,"Recovered":656161,"Active":1603661,"Date":"2020-06-24T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2422299,"Deaths":125026,"Recovered":663562,"Active":1633711,"Date":"2020-06-25T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2467554,"Deaths":125631,"Recovered":670809,"Active":1671114,"Date":"2020-06-26T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2510259,"Deaths":126120,"Recovered":679308,"Active":1704831,"Date":"2020-06-27T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2549294,"Deaths":126360,"Recovered":685164,"Active":1737770,"Date":"2020-06-28T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2590668,"Deaths":126711,"Recovered":705203,"Active":1758754,"Date":"2020-06-29T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2636414,"Deaths":127432,"Recovered":720631,"Active":1788351,"Date":"2020-06-30T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2687588,"Deaths":128105,"Recovered":729994,"Active":1829489,"Date":"2020-07-01T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2739879,"Deaths":128740,"Recovered":781970,"Active":1829169,"Date":"2020-07-02T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2794153,"Deaths":129434,"Recovered":790404,"Active":1874315,"Date":"2020-07-03T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2839436,"Deaths":129676,"Recovered":894325,"Active":1815435,"Date":"2020-07-04T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2888635,"Deaths":129947,"Recovered":906763,"Active":1851925,"Date":"2020-07-05T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2936077,"Deaths":130285,"Recovered":924148,"Active":1881644,"Date":"2020-07-06T00:00:00Z"},{"Country":"United States of America","CountryCode":"","Province":"","City":"","CityCode":"","Lat":"0","Lon":"0","Confirmed":2996098,"Deaths":131480,"Recovered":936476,"Active":1928142,"Date":"2020-07-07T00:00:00Z"}]', 200);

    if (res.statusCode == 200) {
      CountryCase cases = CountryCase(country: country);
      final caseList = json.decode(res.body);
      for (var c in caseList) cases.addCaseFromJSON(c);
      cases.cases.sort((c1, c2) => c1.date.millisecondsSinceEpoch - c2.date.millisecondsSinceEpoch);
      _casesCache[country] = cases;
      return cases;
    } else
      throw Exception('Failed to fetch cases');
  }

  static CountryCase getPredictionsForCountry(Country country, [int pastDataLength = 14]) {
    CountryCase current = _casesCache[country];
    List<Case> lastCases = current.cases.sublist(current.cases.length - pastDataLength);
    List<List<double>> data =
        lastCases.map((e) => [e.deaths.toDouble(), e.recovered.toDouble(), e.active.toDouble()]).toList();
    final nextCase = _Predictor.predict(data).map((e) => e < 0 ? 0 : e).toList();
    return CountryCase(country: country)
      ..cases.addAll(lastCases.sublist(lastCases.length - 7))
      ..cases.add(Case(
        date: lastCases[lastCases.length - 1].date.add(Duration(days: 1)),
        confirmed: (nextCase[0] + nextCase[1] + nextCase[2]).round(),
        deaths: nextCase[0].round(),
        recovered: nextCase[1].round(),
        active: nextCase[2].round(),
      ));
  }
}

class _Predictor {
  static List<double> predict(List<List<double>> lastCases) {
    // transpose list
    Matrix data = Matrix(lastCases).transpose();
    // exponential regression for 0
    final coef0 = linearRegression(Matrix([Iterable<double>.generate(data[0].length, (x) => x.toDouble()).toList()]),
        Matrix([data[0].map(math.log).toList()]));
    // exponential regression for 1
    final coef1 = linearRegression(Matrix([Iterable.generate(data[1].length, (x) => x.toDouble()).toList()]),
        Matrix([data[1].map(math.log).toList()]));
    // find double difference of 1 and 2
    final dx = diff(data[1]), dy = diff(data[2]), ddx = diff(dx), ddy = diff(dy);
    // linear regression between ddx and ddy
    final coef12 = linearRegression(Matrix([ddx]), Matrix([ddy]));

    final next0 = math.exp(coef0[0] * data[0].length + coef0[1]),
        next1 = math.exp(coef1[0] * data[1].length + coef1[1]),
        nextddy = coef12[0] * (next1 - 2 * data[1][data[1].length - 1] + data[1][data[1].length - 2]) + coef12[1],
        next2 = data[2][data[2].length - 1] + dy[dy.length - 1] + nextddy;
    return [next0, next1, next2];
  }

  static List<double> diff(List<double> a) {
    List<double> b = [];
    for (int i = 1, n = a.length; i < n; ++i) b.add(a[i] - a[i - 1]);
    return b;
  }

  static List<double> linearRegression(Matrix x, Matrix y) {
    Matrix x_ = Matrix.fill(x.m + 1, x.n, 1);
    for (int i = 0, m = x.m, n = x.n; i < m; ++i) for (int j = 0; j < n; ++j) x_[i][j] = x[i][j];
    final xt = x_.transpose(), b = y * (xt * (x_ * xt).inverse());
    return b[0];
  }
}
